machine:
  services:
    - docker
  node:
    version: 7.10.0

dependencies:
  cache_directories:
    - "/tmp/nexe"

test:
  override:
    - npm test

deployment:
  production:
    tag: /[0-9]+(\.[0-9]+)*/
    commands:
      - npm run nexe:package
      - docker build -t intellizoom/ecs-docker-reload:latest .
      - docker login -u $DOCKER_USERNAME -p $DOCKER_PASSWORD
      - docker push intellizoom/ecs-docker-reload:latest